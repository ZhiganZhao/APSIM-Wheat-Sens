---
params:
    para: !r list(text = "PotentialExtinctionCoeff", para = list(list(name = "[Leaf].ExtinctionCoeff.PotentialExtinctionCoeff.XYPairs.X", level = c("0, 0.5", "0.0, 0.5", "0.0, 0.5")), list(name = "[Leaf].ExtinctionCoeff.PotentialExtinctionCoeff.XYPairs.Y", level = c("0.3, 0.3", "0.5, 0.5", "0.7, 0.7"))), href = "PotentialExtinctionCoeff.html")

---

---
title: `r params$para$text`: Sensitivity analysis
---

# `r params$para$text`: Sensitivity analysis

```{r setup, message=FALSE, echo=FALSE, warning=FALSE}
library(knitr)
opts_chunk$set(
    cache = FALSE, echo = FALSE, 
    out.width = '100%', fig.asp = 1,
    warning = FALSE, fig.align = 'center',
    message = FALSE) 
library(readr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(xml2)
source('_utility.R')
```

```{r read_data}

para <- params$para
input <- paste0('_simulation/', para$text, '.db.Report.csv')
df <- read.csv(input)

x_var <- c(
    'Wheat.Phenology.Stage',
    'Wheat.Phenology.AccumulateThermalTime')
x_lab <- 'Accumulated thermal time or stage'

```
## Configuration

```{r configuration}

levels <- unlist(lapply(para$para, function(x) length(x$level)))
if (mean(levels) != min(levels)) {
    stop('Levels do not have the same length')
}
level_num <- levels[1]

value <- as.data.frame(lapply(para$para, function(x) {
    y <- list()
    y[[x$name]] <- x$level
    y
}))

data.frame(Cultivar = paste0('Dummy', seq(length = level_num))) %>% 
    cbind(value) %>% 
        kable()

```


## Phenology 

## Structure

## Leaf development

### Leaf area index

```{r leaf-lai, fig.cap='Leaf area index'}
y_cols <- c(
    'Wheat.Leaf.LAI', 
'Wheat.Leaf.LAIDead',
'Wheat.Leaf.LAITotal')
plot_report(df, x_var, y_cols, x_lab = x_lab, y_lab = 'Leaf area index')

```
### Coverage

```{r leaf-cover, fig.cap='Coverage'}
y_cols <- c(
    'Wheat.Leaf.CoverGreen',
    'Wheat.Leaf.CoverDead',
    'Wheat.Leaf.CoverTotal')
plot_report(df, x_var, y_cols, x_lab = x_lab, y_lab = 'Coverage')

```







